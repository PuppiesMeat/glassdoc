# FaceID Data Enrollment

## 1. Goal
As one of the modules in Rokid Glass Mobile Application, Face Data Enrollment help users to enroll face data to face database and then share the face database with the FaceID glass app.

## 2. Features
- allow the user to take a picture or choose a picture from the gallery and then detect the faces and enroll the corresponding person's information into the face database
- Face Information CRUD
- Upload the face database to the glass (will override the previous database or skip version)
- Internationalization (Chinese/English)

## 3. Example Case

### 3.1 Browser Face Data

<img width="202" alt="facedataactivity" src="https://user-images.githubusercontent.com/6252373/49909282-0413e500-fe33-11e8-938f-7c905cc71022.png">

### 3.2 Face Scan

<img width="203" alt="faceeditactivity" src="https://user-images.githubusercontent.com/6252373/49909299-15f58800-fe33-11e8-9c85-117ad1a4d471.png">


### 3.3 Face Data Update

<img width="204" alt="facescanactivity" src="https://user-images.githubusercontent.com/6252373/49909314-27d72b00-fe33-11e8-87ef-f5a9839fbfe3.png">

### 3.4 Face Data Edit

<img width="204" alt="faceupdateactivity" src="https://user-images.githubusercontent.com/6252373/49909317-358cb080-fe33-11e8-8d72-1729190e8b94.png">

## 4. Module Design

### 4.1 Asynchronous Task

In this app inevitably we need to perform many asynchronous tasks, such as uploading and face database operation.
Instead of Android AsyncTask, we use RxJava to handle asynchronous tasks, the use of RxJava please refer to [RxJava](https://github.com/ReactiveX/RxJava)

### 4.2 FaceID SDK Wrapper

This project is powered by the FaceID SDK from Hanzhou, the SDK itself is not exclusively designed for the app, thus we wrap the original SDK into a singleton class called FaceIDSDKHelper. This Helper Class contains different kinds of SDK methods that could be called in more convenient way. For more details, please refer to the SDK class in the codes.

### 4.3 FaceID Database Access Object

The face feature database generated by FaceID SDK is named "face.db", in which we could find out 256-bit float face feature value organized line by line, through the FaceID SDK, we could add/remove/search specific person's face feature.
However, in this project, we not only need the face feature value to do the recognition task, but also need the person's data to be display on the screen, thus we design a Sqlite database called "face_info_db", in which there is a table
contains people's name, company and title information. To connect corresponding rows of information for these two databases, we use the row number as a foreign key in "face_info_db". Also we design a mapping table, which helps us create
multiple face feature for each person, although we don't use it right now.

Notice that the FaceDB SDK is a bit "out-of-date", the remove operation here is so naive that every time you remove a face feature value from the face.db, you need to repair the row number key mapping relationship for the affected items,
for more detail about this operation, please refer to the snippet in the FaceInfoDao class.

### 4.4 Take picture from the camera

This project use File provider for store the URI of picture taken by the camera outside the app, as Android doesn't allow developer get the picture URI directly if SDK version is above 23 or so.

### 4.5 Customized Font

This project use customized font for the UI, the related font file is stored in the font folder under resource path.

### 4.6 Bluetooth Uploading

Bluetooth uploading in this project is actually pretty straightforward, we zip the two application databases "face.db" and "face_info_db" into one database file, then transfer this database file to the glass end through bluetooth socket
in the form of stream. Also we add a lot of UI/UX logic which enable the user to go through the database uploading process more smoothly, for more information please refer to the snippet in the FaceDataActivity class.



# Smart WiFi

## 1. Goal
The Smart WiFi scans all WiFis nearby and display them in a list. The app allows user to select one WiFi, user can then enter password if the network is secure. Finally, the app will display a QR Code that has all information about this the WiFi. Rokid Glass can scan the QR Code then connect to WiFi on Rokid Glass.

## 2. Features
- Scan nearby WiFi using Android WifiManager.
- Display all available WiFis in a RecyclerView (List).
- Enter password for a WiFi if the WiFi is secure.
- Generate QRCode contains all infomation

## 3. Example Case

### 3.1 WiFi Scan and Display In a List

<img width="203" alt="faceeditactivity" src="https://user-images.githubusercontent.com/7017516/49977906-05114900-fefd-11e8-94a2-0a5ceb1bb12c.png">

### 3.2 Enter Password

<img width="204" alt="facescanactivity" src="https://user-images.githubusercontent.com/7017516/49977907-05114900-fefd-11e8-8386-58c43c01d31d.png">

### 3.3 Make Password Visible

<img width="204" alt="faceupdateactivity" src="https://user-images.githubusercontent.com/7017516/49977908-05114900-fefd-11e8-831a-038ae9e43a41.png">

### 3.4 Generate QR Code  
<img width="204" alt="faceupdateactivity" src="https://user-images.githubusercontent.com/7017516/49977909-05114900-fefd-11e8-99d3-2cfca5eff30e.png">

## 4. Structure
Activity Flow:

MainActivity -> WifiScanningActivity -> WifiPasswordActivity(If network is secure) -> WifiQRCodeActivity

## 5. Library

QRCode Library:
[a simple QRCode generation api for java built on top ZXING](https://github.com/kenglxn/QRGen)

We use the library to generate QR Code for creating QR Code. The format is shown below:

```
/**
  * Show UI for secured network with password. User should be able to show password if desired.
  */
private void displayEncryptionNetwork() {
    StringBuilder sb = new StringBuilder();
    sb.append("WIFI:");
    sb.append("S:");
    sb.append(mDataModel.getSSID());
    sb.append(";");
    sb.append("T:");
    // TODO: update it!
    sb.append("WPA");
    sb.append(";");
    sb.append("P:");
    sb.append(mQRCodePassword);
    sb.append(";");
    sb.append(";");
    showQRCodeInImageView(sb.toString());
}
```

The output String is: 
>WIFI:S:ExampleSSID;T:WPA;P:mypassword;;